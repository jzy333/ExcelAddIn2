name: build

on:
 push:
 branches: [ main ]
 pull_request:
 branches: [ main ]

jobs:
 build:
 runs-on: windows-latest
 steps:
 - name: Checkout
 uses: actions/checkout@v4

 - name: Setup MSBuild
 uses: microsoft/setup-msbuild@v2

 - name: Setup VSTO prerequisites (Visual Studio Build Tools)
 uses: egor-tensin/vs-shell@v2

 - name: Restore NuGet
 run: nuget restore ExcelAddIn2.slnx

 - name: Build Release
 run: msbuild ExcelAddIn2.slnx /p:Configuration=Release /m

 - name: Upload Artifacts
 uses: actions/upload-artifact@v4
 with:
 name: ExcelAddIn2-bin-Release
 path: |
 **/bin/Release/**
 **/obj/Release/**
 if-no-files-found: warn
